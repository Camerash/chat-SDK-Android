language: android

android:
  components:
    - platform-tools
    - tools
    - build-tools-23.0.3
    - android-23
    - extra-android-support
    - extra-android-m2repository
    - extra-google-m2repository
    - sys-img-armeabi-v7a-android-19
  licenses:
    - android-sdk-license-.+
    - google-gdk-license-.+

cache:
  directories:
    - $HOME/.gradle/caches/
    - $HOME/.gradle/wrapper/

###
### Uncomment the following lines to enable android emulator
###
# before_script:
  # - echo no | android create avd --force -n test -t android-19 --abi armeabi-v7a
  # - emulator -avd test -no-audio -no-window &
  # - android-wait-for-emulator
  # - adb shell input keyevent 82 &

script:
  - ./gradlew :chat:build --info --stacktrace
  ## Uncomment the following line to enable testing
  # - ./gradlew :chat:connectedAndroidTest --info --stacktrace

before_deploy:
  - sudo pip install awscli
  - sudo pip install https://github.com/SkygearIO/skygear-doc-tools/archive/master.zip
  - aws configure set preview.cloudfront true
  - generate-android-doc --pwd $PWD --src-dir ./chat/src/main/java --package io.skygear.plugins.chat --dst-dir ./javadoc

deploy:
  - provider: script
    script: scripts/deploy.sh
    skip_cleanup: true
    on:
      repo: SkygearIO/chat-SDK-Android
      tags: true

after_deploy:
  - ./scripts/after-deploy.sh

env:
  global:
    - BINTRAY_USER="skygeario-builder"
    # BINTRAY_API_KEY
    - secure: "K7CMHXCLCbHi/a4ztSxfBS126c1S2TM5/sABMHbiu6R7hm5HnthJEzHQ+WFSawTlBh46TlK6c/H2qiBfD7gP7tti7S1g5PbdSFQxcOZTAPEPPJreLBW+n6vXMZowj8Xw87vAm8LEi9ldEEO5280JOTbu5+nu6duYZkWAOpdJ1wOBHd1Mrh9TLVvUm85N3zvpG1PfDLEiEajDDmkEpGWrHtui+a4YTzzalqpoAEPSsLzP9ihHcZ1fuGIO5RJ8WEDhneG1zqEC8nWsb4nxopYva/8OcvB8qojWulOaPZglF9W3WEyqKJvXQREDccNMj3cG2H0vOXFZauzAnXmcY87KILULQGNLoHdVf1a2UpXkuGKeBXVYSD646TWtCRtmX5k/VRGHnefjy5PJAKPzDHCcubad+kOlD/bsEohps25T8JOO4fD5uV+pQ9G6NFiEZNNIrvItp66Xf/0rBT2wBNOXz93/DBiRs+zg+tJCYVp6m51j+p33KKsCQsCGNT9aApRJAoIqr8nG8LeS8jQGyMkbaenn3ERegICXpQeKfyB/V/qk7wea+bv6C/+dvmfKRxnPSgjT0ra+f9iOF4KewU2ChnuTTb6HvP5e21n2jLxwdtPzLp/EzzmRGct8WlaCHuhwUKX7SAbTxdR3BU9LQyD6ygQ9kCrRWkamv7/a7El8qeA="
    # AWS_ACCESS_KEY_ID
    - secure: "l36jp5UM6PVZRy4Dp2vajk1fyKt+MqwuiCe7/Frv513/XCFzO3iDrGnGaoCa5uhwKcx0N4edr/XUouOUNVFTR23KB4FecYdr5ohTyQKem3fakYxLlf7MhjewtKZuccXxJ/bj+8aJufCmSSXpTDSMADz6/ZMYvzD+f1yVNGCDmTpEbyZbTnv/3hJANNkL+CtZ1hfbgX9eIMS/7HN102hB/Bgs03ZiM8lFroWZvmSImbG8WYlPDd1k6VDj03kLSIqGrSVMLu7DYAMv15oplBXSFu5O4iLaAeFrl9nY4QT1RFDBjsG8fJxpXIJgcb9eV505O+8fMyDHv3WWosErHVBlTmRiLq1c4eNfV97jduaJXVQZ/YzealKw5nGEg096xuuz3GbY0tvW8LIHkWJnBXmx/2eaAaEbWzmo8+dBBiB0EBLrrQb0PIvT/hOtWMOGO4kxh6WGChNwaPJZeSlj4xFQCz7Kdozh/mAqNldtRP028h2fIZtFa7Dz9TjEheL1FMzJTyxTg1/oHqY3iueG/3ulMcC7295eBr4faj2zf/8hx/J+rbu5YN7gxviqjOIeTJCOAUwEGj8ieLSFtMV1KIQkAizbMIysAnuaNue9MsG1m/XZRZC/qjrcWJLtdXIU7CXo1uac25TqIcrRYsYMNKK+5tO3IFkcjgUcj0OWbmHb1wE="
    # AWS_SECRET_ACCESS_KEY
    - secure: "uK9HlFcCqvPPsv8HQEAP98MFav9sRd0W92kxM64sLl0MQiY7WKAZ99gR7WteQBZAgEoA2Fwoz1dLERjDXjWIcPIQgcLE0lOzabYNtKTRigXQb7aqX1c1TxWhqhi6mFMAiL3qnpKYg/UjxhtAARcpyUZG4b7w7zq9+Su7wUsO0hvnsdUoy24bWoVrGsnZMPK61DOSXbx6sbC+xHEed9BleBXrAccxwbiH1msnK4T5twcoX7sjJxlaREbU11EUgWXh2fYb1GiF1Uj96j5f77gPDgkUJfbMLK0tUe9ZMelMYta1jKOOOy2rbaihScEf62xSGFL7CADws6no+IWwhm9pXXdqoy8NZN4nauSMtEwO4Iig4itqXU+illlLH+9mtCAQshUaj5mYdGrqdgc00tKYrV8xGSrb/A4PSbxaqC08rG5kO9/y/jMHojzSswhZSMhsx0RV9FPuTXdSmdEitsAIfXQRlULkm5jmht3dzh/9qKh/UxPmUKI/a15hLdTkaBSXAyXlgFJYY06+VOWkuqNzYqXW3M2TgGSqqfLXe38YRhT6dFNSYNp20XRGYur5XVCfTBfZCS4Bfuu1iCLuC3sNYJlqIAK2ZhqACJpy9PbwqFtn/6pQ7PxAd0ljPEzTZRzN2ZtGD3ENoqahbAoUB1VyNdXczFcb99AscQgKIk7U20E="
    # DISTRIBUTION_ID
    - secure: "k3xwtn9zx8Es1cqDdkOtn1fRNZwf+e9btCQCdvjNWgo/4fLKFa+p5dvSHkHBxRRTGIATDkHkuxYZXowteYVNe7lzFetc6OZsLrVf3lz+GjzmCOEk3sSWUL/3x7i+jCnKIjuYQhyX7QzhgxwmBr52yvO/bXno799VidXuqHhM90pXctO8t/Q0bkXM9LtDR7ETIFwtmb/mnWSrQTAdsoqrD5D0TgMeEzRjIxIWxpX5VzjJ0xiW/edLJc5pvnP3qxwiAd2Zh3xx9cF+9dTb4SHpDWonnpTePgj9xCWM3KlO3a3y9R2iV9sm+1B4XgnreA1GfczjiaLB8IMAKSmHzV78CDwM8dWvKw3jgacN3V6aCyYt5VgWuMUs2SDpo5McsWhaLK8/cEBPgZrDFjr9oOojM+dw1zc+Hy2YdqKAHGSOmoFvRFSlxTN2sTzpP4whdqHuJw2Prv4YfviktUmt0mNI/K+I3WgChCG2/Dp/isgJ4qjvDn6FcfRq92c3TVYdOQ71iV70pqlvrlyWnT7iLfgYVejjJmV5gVstqjyURcLpHT4VoEeOUt7eWzX+noKcCW9STM6d0D835YYSHNlM8ajXUrRrQK2XwGn0spbEeFHod5wjmkp4lUOrQqXl/DxnuBtnQExdB/5smt3pPtyJU+OFTB/pR6lcEUz7z8q4FbFzqho="

notifications:
  slack:
    secure: "cp3jllMxq4jHE+YT8S2Cnm2oTvveEbunFOkTt5OjXTsiB78gChYrMy0HRmUBd6tYztiy4Varx+kkYf3lFUkqmCracELREPrs/uJj13Gem5sHYh1qs++oBAVy8P6ACY45r/W2vLEqLOAazWPW7kczeu93P27GnfjfDD9PNne+P/34LQ3D0ev5YZc1E7IQWwXvi8+ODW/NCIXkywcBNpJhXGFNU9obvA4mC+/Yt1aagjUEiZeF6zElqgwWHPEkty+6Pbl0yPQiMm3Mk8hvSkmcJ1Ea8PIdbeYi2Ai7TM3Ru4fiujiuRzCF7iv9Mp2zctYdRTFH20gU6+qBI/SByExOiTWMfgXgL74XWehmIecTs4PZExftXt9RGvKxgjqbBsZKzIP5cqV+6SDX6aJfniu05ObUaJX1EVbBujN2C0Yfj4fiv1RJNyyH3CdmvUnjdYJAsa6yfKfwSkP+nGkizftaAUoCfmjP/tVBPRgmtrZuvF0AoMamOqrmBPPOvtEEkEQH6t54Z3MANiyeHuuEj0BH4895PrHHH98w5XxPrkCqVy2PpRvNM4HHPJ4DcDuDDdpqBQegAMAjWhxJIYc9Bht+JxJH7UmdfrfvluXx6z+Vgs9HjZ2iS09rMv58CNNXT2XyaFPyTJnFjvp6DBckRoxoUf94+5pffG2eKJBOS/JWxKM="
