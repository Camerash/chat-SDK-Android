language: android

android:
  components:
    - platform-tools
    - tools
    - build-tools-23.0.3
    - android-23
    - extra-android-support
    - extra-android-m2repository
    - extra-google-m2repository
    - sys-img-armeabi-v7a-android-19
  licenses:
    - android-sdk-license-.+
    - google-gdk-license-.+

cache:
  directories:
    - $HOME/.gradle/caches/
    - $HOME/.gradle/wrapper/

###
### Uncomment the following lines to enable android emulator
###
# before_script:
  # - echo no | android create avd --force -n test -t android-19 --abi armeabi-v7a
  # - emulator -avd test -no-audio -no-window &
  # - android-wait-for-emulator
  # - adb shell input keyevent 82 &

script:
  - ./gradlew :chat:build --info --stacktrace
  ## Uncomment the following line to enable testing
  # - ./gradlew :chat:connectedAndroidTest --info --stacktrace

before_deploy:
  - ./gradlew :chat:generateJavadocs

deploy:
  - provider: s3
    access_key_id: $AWS_ACCESS_KEY_ID
    secret_access_key: $AWS_SECRET_ACCESS_KEY
    bucket: "docs.skygear.io"
    skip_cleanup: true
    acl: public_read
    local_dir: "chat/build/docs/javadoc"
    upload-dir: "android/plugins/chat/reference"
    cache_control: "max-age=604800"
    on:
      repo: SkygearIO/chat-SDK-Android
      branch: $DEPLOYMENT_BRANCH

after_deploy:
  - ./scripts/after-deploy.sh

env:
  global:
    - DEPLOYMENT_BRANCH="master"
    # AWS_ACCESS_KEY_ID
    - secure: "tSXrySl+9MjBNsvHWV4VLPqp0cazjJv60JC+PRPzuorGRc8lCj992QCTQw47vrriW+v1/nZNuCrXySNRKNfuevUdBT72Ij/r1ll5fGErueghu3X2zzInVhx0PxK8GlAzhSpcg2KKs1nqnaLHz/2Lnani+Wc/cxf6D89SbYvEV9lZ5v9mqq1pSdwOc9Z1/YGua9Hw0MDDn81Yh5WQQIUCXqDomtD9OgFF/ODR/DwmKxVZOXiJr88LzEP0z8aei57hAQZgKPCFqHOKRqWcS/r6K1zVnilFoEYvoEQOMGIfDOVaxvFVoQukXDjadbvfioJKhzofzU7WitPPo0NrzTLyvvxduOkuIWLqGaC0OlNI62Q6y+LNClzLUX8tC2PsIZZzkBI3SsMWoWewJBHPx0ZOhkC5GXoyCf3XJ3r7LkqpY/D3k5XPWD63NAwphplG9FCw82vxECev9L77pFb8zbEtNz4l6vPai5AYSIEY+aHlAw4hQcGxvjxdfCxib//VSvAe00shnbr0l1eXinDsBuYLUO3PGt9cdC8A4r5+cmO9uvecNplv6In+lX096zK4hDg0RHS94VQ8dcErpNwpa40gbeids/u6Gb1nJ+12L6gB4q/wTvc+xMs74VVf5wpx6yA4Wx3uN+3cL8Ez+wW6X87wEkEXctLOgRDUswH92GFqWAE="
    # AWS_SECRET_ACCESS_KEY
    - secure: "P/aLKyxqdsUjgu6ZUTQmFFBSVuwVOQ+CMGVuSxQSbhUfrbvtJB5nBLgSE/0PFZM0e0SseeMXdbET+O+XJsepD2Mu8mAkxwAMec2cJzfzMjzZuoewrooxvE4zICqadDlgCyEi7Ox5gfoLPfBxbS3WcXnMu/PiCKXfUjYAt4YdRxZHHgVfEIQVWKMTV+aaTy6y86dtL9OQV9bWtaHzTqxk62bhjzLHvPaZGe6aELggat++D9XRJMgUdgmkzWJBoGUyLFtIo5ZY9MgcsHlzy8spWXd9b9PAgrqyJLQlt4lJM/zm3Ef/ErcuLrwi8QgyCkn7b3rwIrviwTcwZckfY8ovksOoXiAbRrwauoU5Y409FDun0ghoEw7PaH6tF484DBHu7pBLlwVCXb17apHbG96fnsFWwCAHL1eTcYqzNwOHV5Psow8p6OGsnUoJ7LYEOtDGHAlxABh2VUiUbM6BwHqfJDzAeQ/Uxm8TPtDn8ozSp3mucTLXh3ViYBOnmkfCC+yj+V1qan9YY59ZF/EXJk8jcTnwwHgNf2tKMLCDK2NSn8y950UZHMZ2TPRIWwAmlCnE7qzhHj/8uTvYtM7RoIEmVpk2wfO1fWOeRih9ysZQD3Nozdptz4qtoDlleGEC14RiMs8+Z/810lxqmnD8I0hmtyLMFz3t6U+HPUMnEiRD19Y="
    # DISTRIBUTION_ID
    - secure: "k3xwtn9zx8Es1cqDdkOtn1fRNZwf+e9btCQCdvjNWgo/4fLKFa+p5dvSHkHBxRRTGIATDkHkuxYZXowteYVNe7lzFetc6OZsLrVf3lz+GjzmCOEk3sSWUL/3x7i+jCnKIjuYQhyX7QzhgxwmBr52yvO/bXno799VidXuqHhM90pXctO8t/Q0bkXM9LtDR7ETIFwtmb/mnWSrQTAdsoqrD5D0TgMeEzRjIxIWxpX5VzjJ0xiW/edLJc5pvnP3qxwiAd2Zh3xx9cF+9dTb4SHpDWonnpTePgj9xCWM3KlO3a3y9R2iV9sm+1B4XgnreA1GfczjiaLB8IMAKSmHzV78CDwM8dWvKw3jgacN3V6aCyYt5VgWuMUs2SDpo5McsWhaLK8/cEBPgZrDFjr9oOojM+dw1zc+Hy2YdqKAHGSOmoFvRFSlxTN2sTzpP4whdqHuJw2Prv4YfviktUmt0mNI/K+I3WgChCG2/Dp/isgJ4qjvDn6FcfRq92c3TVYdOQ71iV70pqlvrlyWnT7iLfgYVejjJmV5gVstqjyURcLpHT4VoEeOUt7eWzX+noKcCW9STM6d0D835YYSHNlM8ajXUrRrQK2XwGn0spbEeFHod5wjmkp4lUOrQqXl/DxnuBtnQExdB/5smt3pPtyJU+OFTB/pR6lcEUz7z8q4FbFzqho="
