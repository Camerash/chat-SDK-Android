language: android

android:
  components:
    - platform-tools
    - tools
    - build-tools-23.0.3
    - android-23
    - extra-android-support
    - extra-android-m2repository
    - extra-google-m2repository
    - sys-img-armeabi-v7a-android-19
  licenses:
    - android-sdk-license-.+
    - google-gdk-license-.+

cache:
  directories:
    - $HOME/.gradle/caches/
    - $HOME/.gradle/wrapper/

###
### Uncomment the following lines to enable android emulator
###
# before_script:
  # - echo no | android create avd --force -n test -t android-19 --abi armeabi-v7a
  # - emulator -avd test -no-audio -no-window &
  # - android-wait-for-emulator
  # - adb shell input keyevent 82 &

script:
  - ./gradlew :chat:build --info --stacktrace
  ## Uncomment the following line to enable testing
  # - ./gradlew :chat:connectedAndroidTest --info --stacktrace

before_deploy:
  - ./gradlew :chat:generateJavadocs

deploy:
  - provider: s3
    access_key_id: $AWS_ACCESS_KEY_ID
    secret_access_key: $AWS_SECRET_ACCESS_KEY
    bucket: "docs.skygear.io"
    skip_cleanup: true
    acl: public_read
    local_dir: "chat/build/docs/javadoc"
    upload-dir: "android/plugins/chat/reference"
    cache_control: "max-age=604800"
    on:
      repo: SkygearIO/chat-SDK-Android
      branch: $DEPLOYMENT_BRANCH

after_deploy:
  - ./scripts/after-deploy.sh

env:
  global:
    - DEPLOYMENT_BRANCH="master"
    # AWS_ACCESS_KEY_ID
    - secure: "l36jp5UM6PVZRy4Dp2vajk1fyKt+MqwuiCe7/Frv513/XCFzO3iDrGnGaoCa5uhwKcx0N4edr/XUouOUNVFTR23KB4FecYdr5ohTyQKem3fakYxLlf7MhjewtKZuccXxJ/bj+8aJufCmSSXpTDSMADz6/ZMYvzD+f1yVNGCDmTpEbyZbTnv/3hJANNkL+CtZ1hfbgX9eIMS/7HN102hB/Bgs03ZiM8lFroWZvmSImbG8WYlPDd1k6VDj03kLSIqGrSVMLu7DYAMv15oplBXSFu5O4iLaAeFrl9nY4QT1RFDBjsG8fJxpXIJgcb9eV505O+8fMyDHv3WWosErHVBlTmRiLq1c4eNfV97jduaJXVQZ/YzealKw5nGEg096xuuz3GbY0tvW8LIHkWJnBXmx/2eaAaEbWzmo8+dBBiB0EBLrrQb0PIvT/hOtWMOGO4kxh6WGChNwaPJZeSlj4xFQCz7Kdozh/mAqNldtRP028h2fIZtFa7Dz9TjEheL1FMzJTyxTg1/oHqY3iueG/3ulMcC7295eBr4faj2zf/8hx/J+rbu5YN7gxviqjOIeTJCOAUwEGj8ieLSFtMV1KIQkAizbMIysAnuaNue9MsG1m/XZRZC/qjrcWJLtdXIU7CXo1uac25TqIcrRYsYMNKK+5tO3IFkcjgUcj0OWbmHb1wE="
    # AWS_SECRET_ACCESS_KEY
    - secure: "uK9HlFcCqvPPsv8HQEAP98MFav9sRd0W92kxM64sLl0MQiY7WKAZ99gR7WteQBZAgEoA2Fwoz1dLERjDXjWIcPIQgcLE0lOzabYNtKTRigXQb7aqX1c1TxWhqhi6mFMAiL3qnpKYg/UjxhtAARcpyUZG4b7w7zq9+Su7wUsO0hvnsdUoy24bWoVrGsnZMPK61DOSXbx6sbC+xHEed9BleBXrAccxwbiH1msnK4T5twcoX7sjJxlaREbU11EUgWXh2fYb1GiF1Uj96j5f77gPDgkUJfbMLK0tUe9ZMelMYta1jKOOOy2rbaihScEf62xSGFL7CADws6no+IWwhm9pXXdqoy8NZN4nauSMtEwO4Iig4itqXU+illlLH+9mtCAQshUaj5mYdGrqdgc00tKYrV8xGSrb/A4PSbxaqC08rG5kO9/y/jMHojzSswhZSMhsx0RV9FPuTXdSmdEitsAIfXQRlULkm5jmht3dzh/9qKh/UxPmUKI/a15hLdTkaBSXAyXlgFJYY06+VOWkuqNzYqXW3M2TgGSqqfLXe38YRhT6dFNSYNp20XRGYur5XVCfTBfZCS4Bfuu1iCLuC3sNYJlqIAK2ZhqACJpy9PbwqFtn/6pQ7PxAd0ljPEzTZRzN2ZtGD3ENoqahbAoUB1VyNdXczFcb99AscQgKIk7U20E="
    # DISTRIBUTION_ID
    - secure: "k3xwtn9zx8Es1cqDdkOtn1fRNZwf+e9btCQCdvjNWgo/4fLKFa+p5dvSHkHBxRRTGIATDkHkuxYZXowteYVNe7lzFetc6OZsLrVf3lz+GjzmCOEk3sSWUL/3x7i+jCnKIjuYQhyX7QzhgxwmBr52yvO/bXno799VidXuqHhM90pXctO8t/Q0bkXM9LtDR7ETIFwtmb/mnWSrQTAdsoqrD5D0TgMeEzRjIxIWxpX5VzjJ0xiW/edLJc5pvnP3qxwiAd2Zh3xx9cF+9dTb4SHpDWonnpTePgj9xCWM3KlO3a3y9R2iV9sm+1B4XgnreA1GfczjiaLB8IMAKSmHzV78CDwM8dWvKw3jgacN3V6aCyYt5VgWuMUs2SDpo5McsWhaLK8/cEBPgZrDFjr9oOojM+dw1zc+Hy2YdqKAHGSOmoFvRFSlxTN2sTzpP4whdqHuJw2Prv4YfviktUmt0mNI/K+I3WgChCG2/Dp/isgJ4qjvDn6FcfRq92c3TVYdOQ71iV70pqlvrlyWnT7iLfgYVejjJmV5gVstqjyURcLpHT4VoEeOUt7eWzX+noKcCW9STM6d0D835YYSHNlM8ajXUrRrQK2XwGn0spbEeFHod5wjmkp4lUOrQqXl/DxnuBtnQExdB/5smt3pPtyJU+OFTB/pR6lcEUz7z8q4FbFzqho="
